// @copyright Copyright (c) 2018 Palantir.net

.sidebar {
  margin: 0 0 rhythm(1);
}

.sidebar-nav--trigger {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  border-radius: 0;
  background-color: $gray-lt;
  border: 0;
  padding: rhythm(.5) rhythm(1);
  color: $blue-gray;

  svg {
    fill: $blue-gray;
    height: 14px;
    width: 14px;
    transform: rotate(90deg);
  }

  &:active,
  &:hover,
  &:focus {
    background-color: $blue-gray-dk;
    color: $white;
    transform: scale(1);

    svg {
      fill: $white;
    }
  }

  &.is-active {
    background-color: $blue-gray-dk;
    color: $white;

    svg {
      fill: $white;
      transform: rotate(0deg);
    }
  }

  @include breakpoint($bp3) {
    display: none;
  }
}

.sidebar-nav {
  display: none;
  box-shadow: 0 0 10px rgba($gray-dk, .3);
  background-color: $white;
  margin: 0 0 rhythm(1);
  padding: rhythm(.5) 0;

  @include breakpoint($bp3) {
    @include adjust-font-size-to(20px, 1.15);
    display: block;
    margin: 0;
  }
}

.sidebar-nav__parent-list,
.sidebar-nav__list,
.sidebar-nav__child-list {
  list-style: none;
  margin: 0;
  padding: 0;
  
  li {
    margin-bottom: 0;
  }
}

.sidebar-nav__parent {
  border-top: 1px solid $gray-lt;
  
  &:first-child {
    border-top: none;
  }
}

.sidebar-nav__item-container {
  display: flex;
  align-content: stretch;

  span {
    display: block;
  }

  &.no-children {
    
     a.is-active {
      background-color: $gray-lt;
      color: $gray-dk;
    }
    
    a:link,
    a:visited {
      padding: rhythm(.6) rhythm(1.5);

      .sidebar-nav__parent & {
        padding: rhythm(.45) rhythm(2.25);
      }
      
      .sidebar--internal & {
        padding: rhythm(.6) rhythm(1.5);
      }
    }
  }
}

.sidebar-nav__parent-container {
  text-transform: uppercase;
  display: flex;
  align-content: stretch;

  a:link,
  a:visited {
    display: block;
    width: 100%;
    color: $blue-gray;
    padding: rhythm(.6) rhythm(1) rhythm(.6) rhythm(.25);
    text-decoration: none;
  }

  a:active,
  a:hover,
  a:focus {
    text-decoration: none;
    background-color: $gray-lt;
  }

  a.is-active {
    background-color: $gray-lt;
    color: $gray-dk;
  }

  &.no-children {
    a:link,
    a:visited {
      padding: rhythm(.6) rhythm(.5) rhythm(.6) rhythm(1);
    }
  }
}

.sidebar-nav__parent-item {
  display: block;
  width: 100%;
  color: $blue-gray;
  padding: rhythm(.5) rhythm(1);

  .sidebar-nav__parent & {
    padding-left: rhythm(1.75);
  }
}

.sidebar-nav__item {
  border-top: 1px solid $gray-lt;
  display: block;
  
  a:link,
  a:visited {
    display: block;
    width: 100%;
    color: $blue-gray;
    padding: rhythm(.6) rhythm(1) rhythm(.6) rhythm(.25);
    text-decoration: none;
  }

  a:active,
  a:hover,
  a:focus {
    text-decoration: none;
    background-color: $gray-lt;
  }
}

.sidebar-nav__parent-trigger,
.sidebar-nav__item-trigger {
  background-color: transparent;
  border-radius: 0;
  border: 0;
  color: $blue-gray;
  padding: rhythm(.6) rhythm(.75) rhythm(.6) rhythm(1.75);

  .sidebar-nav__parent-list & {
    padding-left: rhythm(2.25);
  }
  
  .sidebar--internal & {
    padding-left: rhythm(1.5);
  }

  svg {
    height: 10px;
    width: 10px;
    fill: $blue-gray;
  }

  &:active,
  &:hover,
  &:focus {
    color: $blue-gray;
    background-color: $gray-lt;
    transform: scale(1);
  }
}

.sidebar-nav__parent.is-active .sidebar-nav__parent-trigger {

    svg {
      transform: rotate(90deg);
    }
  }

.sidebar-nav__item.is-active .sidebar-nav__item-trigger {

    svg {
      transform: rotate(90deg);
    }
  }

.sidebar-nav__parent-trigger--no-link {
  display: flex;
  align-content: stretch;
  align-items: center;
  width: 100%;
  text-align: left;
  padding: rhythm(.6) rhythm(1.5) rhythm(.6) rhythm(1.6);

  span {
    padding-left: rhythm(.4);
  }

  svg {
    height: 10px;
    width: 10px;
    fill: $blue-gray;
  }
}

.sidebar-nav__item-trigger--no-link {
  display: flex;
  align-content: stretch;
  align-items: center;
  text-transform: capitalize;
  width: 100%;
  text-align: left;
  padding: rhythm(.6) rhythm(1.5) rhythm(.6) rhythm(1.6);

  span {
    display: block;
    padding-left: rhythm(.5);
  }

  svg {
    height: 10px;
    width: 10px;
    fill: $blue-gray;
  }
}

.sidebar-nav__parent-list {
  visibility: hidden;
  max-height: 0;
  overflow: hidden;
  transition: max-height .5s ease, visibility 0s .5s ease;

  .sidebar-nav__parent.is-active & {
    visibility: visible;
    max-height: 1000px;
    transition: max-height 1.5s ease, visibility 0s 0s ease;
  }
}

.sidebar-nav__child-list {
  visibility: hidden;
  max-height: 0;
  overflow: hidden;
  transition: max-height .5s ease, visibility 0s .5s ease;

  .sidebar-nav__item.is-active & {
    visibility: visible;
    max-height: 1000px;
    transition: max-height 1.5s ease, visibility 0s 0s ease;
    padding-bottom: rhythm(.5);
  }
}

.sidebar-nav__child {
  text-transform: capitalize;

  > a:link,
  > a:visited {
    display: block;
    color: $blue-gray;
    text-decoration: none;
    padding: rhythm(.45) rhythm(1) rhythm(.45) rhythm(2.75);

    .sidebar-nav__parent & {
      padding-left: rhythm(3);
    }
    
    .sidebar--internal & {
      padding-left: rhythm(2.5);
    }
    
    &:before {
      content: "-";
      display: inline-block;
      position: relative;
      left: -12px;
      width: 0;
    }
  }

  > a:active,
  > a:hover,
  > a:focus {
    text-decoration: none;
    background-color: $gray-lt;
  }

  &.is-active > a:link,
  &.is-active > a:visited {
    background-color: $gray-lt;
    color: $gray-dk;
  }
  // Variant for overview which renders as a link with the 'is-active' class.
  a.is-active {
    background-color: $gray-lt;
    color: $gray-dk;
  }
}

.sidebar-nav__item__title {
  text-transform: uppercase;
  color: $black;
  padding: rhythm(1) rhythm(1.5) rhythm(.6);
}
